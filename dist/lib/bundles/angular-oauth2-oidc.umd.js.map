{
  "version": 3,
  "file": "angular-oauth2-oidc.umd.js",
  "sources": [
    "ng://angular-oauth2-oidc/out/tokens.ts",
    "ng://angular-oauth2-oidc/out/token-validation/jwks-validation-handler.ts",
    "ng://angular-oauth2-oidc/out/angular-oauth-oidic.module.ts",
    "ng://angular-oauth2-oidc/out/token-validation/null-validation-handler.ts",
    "ng://angular-oauth2-oidc/out/interceptors/default-oauth.interceptor.ts",
    "ng://angular-oauth2-oidc/out/interceptors/resource-server-error-handler.ts",
    "ng://angular-oauth2-oidc/out/oauth-module.config.ts",
    "ng://angular-oauth2-oidc/out/oauth-service.ts",
    "ng://angular-oauth2-oidc/out/encoder.ts",
    "ng://angular-oauth2-oidc/out/auth.config.ts",
    "ng://angular-oauth2-oidc/out/base64-helper.ts",
    "ng://angular-oauth2-oidc/out/events.ts",
    "ng://angular-oauth2-oidc/out/url-helper.service.ts",
    "ng://angular-oauth2-oidc/out/token-validation/validation-handler.ts",
    "ng://angular-oauth2-oidc/out/types.ts",
    "ng://angular-oauth2-oidc/node_modules/tslib/tslib.es6.js"
  ],
  "sourcesContent": [
    "import { InjectionToken } from '@angular/core';\nimport { AuthConfig } from './auth.config';\n\nexport const AUTH_CONFIG = new InjectionToken<AuthConfig>('AUTH_CONFIG');\n",
    "import {\n  AbstractValidationHandler,\n  ValidationParams\n} from './validation-handler';\n\n// declare var require: any;\n// let rs = require('jsrsasign');\n\nimport * as rs from 'jsrsasign';\n\n/**\n * Validates the signature of an id_token against one\n * of the keys of an JSON Web Key Set (jwks).\n *\n * This jwks can be provided by the discovery document.\n */\nexport class JwksValidationHandler extends AbstractValidationHandler {\n  /**\n   * Allowed algorithms\n   */\n  allowedAlgorithms: string[] = [\n    'HS256',\n    'HS384',\n    'HS512',\n    'RS256',\n    'RS384',\n    'RS512',\n    'ES256',\n    'ES384',\n    'PS256',\n    'PS384',\n    'PS512'\n  ];\n\n  /**\n   * Time period in seconds the timestamp in the signature can\n   * differ from the current time.\n   */\n  gracePeriodInSec = 600;\n\n  validateSignature(params: ValidationParams, retry = false): Promise<any> {\n    if (!params.idToken) throw new Error('Parameter idToken expected!');\n    if (!params.idTokenHeader)\n      throw new Error('Parameter idTokenHandler expected.');\n    if (!params.jwks) throw new Error('Parameter jwks expected!');\n\n    if (\n      !params.jwks['keys'] ||\n      !Array.isArray(params.jwks['keys']) ||\n      params.jwks['keys'].length === 0\n    ) {\n      throw new Error('Array keys in jwks missing!');\n    }\n\n    // console.debug('validateSignature: retry', retry);\n\n    let kid: string = params.idTokenHeader['kid'];\n    let keys: object[] = params.jwks['keys'];\n    let key: object;\n\n    let alg = params.idTokenHeader['alg'];\n\n    if (kid) {\n      key = keys.find(k => k['kid'] === kid /* && k['use'] === 'sig' */);\n    } else {\n      let kty = this.alg2kty(alg);\n      let matchingKeys = keys.filter(\n        k => k['kty'] === kty && k['use'] === 'sig'\n      );\n\n      /*\n            if (matchingKeys.length == 0) {\n                let error = 'No matching key found.';\n                console.error(error);\n                return Promise.reject(error);\n            }*/\n      if (matchingKeys.length > 1) {\n        let error =\n          'More than one matching key found. Please specify a kid in the id_token header.';\n        console.error(error);\n        return Promise.reject(error);\n      } else if (matchingKeys.length === 1) {\n        key = matchingKeys[0];\n      }\n    }\n\n    if (!key && !retry && params.loadKeys) {\n      return params\n        .loadKeys()\n        .then(loadedKeys => (params.jwks = loadedKeys))\n        .then(_ => this.validateSignature(params, true));\n    }\n\n    if (!key && retry && !kid) {\n      let error = 'No matching key found.';\n      console.error(error);\n      return Promise.reject(error);\n    }\n\n    if (!key && retry && kid) {\n      let error =\n        'expected key not found in property jwks. ' +\n        'This property is most likely loaded with the ' +\n        'discovery document. ' +\n        'Expected key id (kid): ' +\n        kid;\n\n      console.error(error);\n      return Promise.reject(error);\n    }\n\n    let keyObj = rs.KEYUTIL.getKey(key);\n    let validationOptions = {\n      alg: this.allowedAlgorithms,\n      gracePeriod: this.gracePeriodInSec\n    };\n    let isValid = rs.KJUR.jws.JWS.verifyJWT(\n      params.idToken,\n      keyObj,\n      validationOptions\n    );\n\n    if (isValid) {\n      return Promise.resolve();\n    } else {\n      return Promise.reject('Signature not valid');\n    }\n  }\n\n  private alg2kty(alg: string) {\n    switch (alg.charAt(0)) {\n      case 'R':\n        return 'RSA';\n      case 'E':\n        return 'EC';\n      default:\n        throw new Error('Cannot infer kty from alg: ' + alg);\n    }\n  }\n\n  calcHash(valueToHash: string, algorithm: string): string {\n    let hashAlg = new rs.KJUR.crypto.MessageDigest({ alg: algorithm });\n    let result = hashAlg.digestString(valueToHash);\n    let byteArrayAsString = this.toByteArrayAsString(result);\n    return byteArrayAsString;\n  }\n\n  toByteArrayAsString(hexString: string) {\n    let result = '';\n    for (let i = 0; i < hexString.length; i += 2) {\n      let hexDigit = hexString.charAt(i) + hexString.charAt(i + 1);\n      let num = parseInt(hexDigit, 16);\n      result += String.fromCharCode(num);\n    }\n    return result;\n  }\n}\n",
    "import { OAuthStorage } from './types';\nimport { NgModule, ModuleWithProviders } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HTTP_INTERCEPTORS, HttpClientModule } from '@angular/common/http';\n\nimport { OAuthService } from './oauth-service';\nimport { UrlHelperService } from './url-helper.service';\n\nimport { OAuthModuleConfig } from './oauth-module.config';\nimport {\n  OAuthResourceServerErrorHandler,\n  OAuthNoopResourceServerErrorHandler\n} from './interceptors/resource-server-error-handler';\nimport { DefaultOAuthInterceptor } from './interceptors/default-oauth.interceptor';\nimport { ValidationHandler } from './token-validation/validation-handler';\nimport { NullValidationHandler } from './token-validation/null-validation-handler';\n\nexport function createDefaultStorage() {\n  return typeof sessionStorage !== 'undefined' ? sessionStorage : null;\n}\n\n@NgModule({\n  imports: [CommonModule],\n  declarations: [],\n  exports: []\n})\nexport class OAuthModule {\n  static forRoot(\n    config: OAuthModuleConfig = null,\n    validationHandlerClass = NullValidationHandler\n  ): ModuleWithProviders {\n    // const setupInterceptor = config && config.resourceServer && config.resourceServer.allowedUrls;\n\n    return {\n      ngModule: OAuthModule,\n      providers: [\n        OAuthService,\n        UrlHelperService,\n        { provide: OAuthStorage, useFactory: createDefaultStorage },\n        { provide: ValidationHandler, useClass: validationHandlerClass},\n        {\n          provide: OAuthResourceServerErrorHandler,\n          useClass: OAuthNoopResourceServerErrorHandler\n        },\n        { provide: OAuthModuleConfig, useValue: config },\n        {\n          provide: HTTP_INTERCEPTORS,\n          useClass: DefaultOAuthInterceptor,\n          multi: true\n        }\n      ]\n    };\n  }\n}\n",
    "import { ValidationHandler, ValidationParams } from './validation-handler';\n\n/**\n * A validation handler that isn't validating nothing.\n * Can be used to skip validation (on your own risk).\n */\nexport class NullValidationHandler implements ValidationHandler {\n  validateSignature(validationParams: ValidationParams): Promise<any> {\n    return Promise.resolve(null);\n  }\n  validateAtHash(validationParams: ValidationParams): boolean {\n    return true;\n  }\n}\n",
    "import { Injectable, Inject, Optional } from '@angular/core';\nimport { OAuthService } from '../oauth-service';\nimport { OAuthStorage } from '../types';\nimport {\n    HttpEvent,\n    HttpHandler,\n    HttpInterceptor,\n    HttpRequest,\n    HttpResponse,\n    HttpErrorResponse\n} from '@angular/common/http';\nimport { Observable } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { OAuthResourceServerErrorHandler } from './resource-server-error-handler';\nimport { OAuthModuleConfig } from '../oauth-module.config';\n\n@Injectable()\nexport class DefaultOAuthInterceptor implements HttpInterceptor {\n    constructor(\n        private authStorage: OAuthStorage,\n        private errorHandler: OAuthResourceServerErrorHandler,\n        @Optional() private moduleConfig: OAuthModuleConfig\n    ) { }\n\n    private checkUrl(url: string): boolean {\n        const found = this.moduleConfig.resourceServer.allowedUrls.find(u => url.startsWith(u));\n        return !!found;\n    }\n\n    public intercept(\n        req: HttpRequest<any>,\n        next: HttpHandler\n    ): Observable<HttpEvent<any>> {\n        const url = req.url.toLowerCase();\n\n        if (!this.moduleConfig) {\n            return next.handle(req);\n        }\n        if (!this.moduleConfig.resourceServer) {\n            return next.handle(req);\n        }\n        if (this.moduleConfig.resourceServer.allowedUrls && !this.checkUrl(url)) {\n            return next.handle(req);\n        }\n\n        const sendAccessToken = this.moduleConfig.resourceServer.sendAccessToken;\n\n        if (sendAccessToken && this.authStorage.getItem('access_token')) {\n            const token = this.authStorage.getItem('access_token');\n            const header = 'Bearer ' + token;\n\n            const headers = req.headers.set('Authorization', header);\n\n            req = req.clone({ headers });\n        }\n\n        return next\n            .handle(req)\n            .pipe(catchError(err => this.errorHandler.handleError(err)));\n    }\n}\n",
    "import { HttpResponse } from '@angular/common/http';\nimport { Observable, throwError } from 'rxjs';\n\nexport abstract class OAuthResourceServerErrorHandler {\n  abstract handleError(err: HttpResponse<any>): Observable<any>;\n}\n\nexport class OAuthNoopResourceServerErrorHandler\n  implements OAuthResourceServerErrorHandler {\n  handleError(err: HttpResponse<any>): Observable<any> {\n    return throwError(err);\n  }\n}\n",
    "export abstract class OAuthModuleConfig {\n  resourceServer: OAuthResourceServerConfig;\n}\n\nexport abstract class OAuthResourceServerConfig {\n  /**\n   * Urls for which calls should be intercepted.\n   * If there is an ResourceServerErrorHandler registered, it is used for them.\n   * If sendAccessToken is set to true, the access_token is send to them too.\n   */\n  allowedUrls?: Array<string>;\n  sendAccessToken: boolean;\n}\n",
    "import { Injectable, NgZone, Optional } from '@angular/core';\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Observable, Subject, Subscription, of, race } from 'rxjs';\nimport { filter, take, delay, first, tap, map } from 'rxjs/operators';\n\nimport {\n    ValidationHandler,\n    ValidationParams\n} from './token-validation/validation-handler';\nimport { UrlHelperService } from './url-helper.service';\nimport {\n    OAuthEvent,\n    OAuthInfoEvent,\n    OAuthErrorEvent,\n    OAuthSuccessEvent\n} from './events';\nimport {\n    OAuthStorage,\n    LoginOptions,\n    ParsedIdToken,\n    OidcDiscoveryDoc,\n    TokenResponse,\n    UserInfo\n} from './types';\nimport { b64DecodeUnicode } from './base64-helper';\nimport { AuthConfig } from './auth.config';\nimport { WebHttpUrlEncodingCodec } from './encoder';\n\n/**\n * Service for logging in and logging out with\n * OIDC and OAuth2. Supports implicit flow and\n * password flow.\n */\n@Injectable()\nexport class OAuthService extends AuthConfig {\n    // extending AuthConfig ist just for LEGACY reasons\n    // to not break existing code\n\n    /**\n     * The ValidationHandler used to validate received\n     * id_tokens.\n     */\n    public tokenValidationHandler: ValidationHandler;\n\n    /**\n     * @internal\n     * Deprecated:  use property events instead\n     */\n    public discoveryDocumentLoaded = false;\n\n    /**\n     * @internal\n     * Deprecated:  use property events instead\n     */\n    public discoveryDocumentLoaded$: Observable<object>;\n\n    /**\n     * Informs about events, like token_received or token_expires.\n     * See the string enum EventType for a full list of events.\n     */\n    public events: Observable<OAuthEvent>;\n\n    /**\n     * The received (passed around) state, when logging\n     * in with implicit flow.\n     */\n    public state?= '';\n\n    private eventsSubject: Subject<OAuthEvent> = new Subject<OAuthEvent>();\n    private discoveryDocumentLoadedSubject: Subject<object> = new Subject<\n        object\n        >();\n    private silentRefreshPostMessageEventListener: EventListener;\n    private grantTypesSupported: Array<string> = [];\n    private _storage: OAuthStorage;\n    private accessTokenTimeoutSubscription: Subscription;\n    private idTokenTimeoutSubscription: Subscription;\n    private sessionCheckEventListener: EventListener;\n    private jwksUri: string;\n    private sessionCheckTimer: any;\n    private silentRefreshSubject: string;\n    private inImplicitFlow = false;\n\n    constructor(\n        private ngZone: NgZone,\n        private http: HttpClient,\n        @Optional() storage: OAuthStorage,\n        @Optional() tokenValidationHandler: ValidationHandler,\n        @Optional() private config: AuthConfig,\n        private urlHelper: UrlHelperService\n    ) {\n        super();\n\n        this.discoveryDocumentLoaded$ = this.discoveryDocumentLoadedSubject.asObservable();\n        this.events = this.eventsSubject.asObservable();\n\n        if (tokenValidationHandler) {\n            this.tokenValidationHandler = tokenValidationHandler;\n        }\n\n        if (config) {\n            this.configure(config);\n        }\n\n        try {\n            if (storage) {\n                this.setStorage(storage);\n            } else if (typeof sessionStorage !== 'undefined') {\n                this.setStorage(sessionStorage);\n            }\n        } catch (e) {\n            console.error(\n                'cannot access sessionStorage. Consider setting an own storage implementation using setStorage',\n                e\n            );\n        }\n        this.setupRefreshTimer();\n    }\n\n    /**\n     * Use this method to configure the service\n     * @param config the configuration\n     */\n    public configure(config: AuthConfig) {\n        // For the sake of downward compatibility with\n        // original configuration API\n        Object.assign(this, new AuthConfig(), config);\n\n        this.config = Object.assign({} as AuthConfig, new AuthConfig(), config);\n\n        if (this.sessionChecksEnabled) {\n            this.setupSessionCheck();\n        }\n\n        this.configChanged();\n    }\n\n    private configChanged(): void { }\n\n    public restartSessionChecksIfStillLoggedIn(): void {\n        if (this.hasValidIdToken()) {\n            this.initSessionCheck();\n        }\n    }\n\n    private restartRefreshTimerIfStillLoggedIn(): void {\n        this.setupExpirationTimers();\n    }\n\n    private setupSessionCheck() {\n        this.events.pipe(filter(e => e.type === 'token_received')).subscribe(e => {\n            this.initSessionCheck();\n        });\n    }\n\n    /**\n     *\n     * @param params Additional parameter to pass\n     */\n    public setupAutomaticSilentRefresh(params: object = {}) {\n        this.events.pipe(filter(e => e.type === 'token_expires')).subscribe(e => {\n            this.silentRefresh(params).catch(_ => {\n                this.debug('automatic silent refresh did not work');\n            });\n        });\n\n        this.restartRefreshTimerIfStillLoggedIn();\n    }\n\n    public loadDiscoveryDocumentAndTryLogin(options: LoginOptions = null) {\n        return this.loadDiscoveryDocument().then(doc => {\n            return this.tryLogin(options);\n        });\n    }\n\n    public loadDiscoveryDocumentAndLogin(options: LoginOptions = null) {\n        return this.loadDiscoveryDocumentAndTryLogin(options).then(_ => {\n            if (!this.hasValidIdToken() || !this.hasValidAccessToken()) {\n                this.initImplicitFlow();\n                return false;\n            } else {\n                return true;\n            }\n        });\n    }\n\n    private debug(...args): void {\n        if (this.showDebugInformation) {\n            console.debug.apply(console, args);\n        }\n    }\n\n    private validateUrlFromDiscoveryDocument(url: string): string[] {\n        const errors: string[] = [];\n        const httpsCheck = this.validateUrlForHttps(url);\n        const issuerCheck = this.validateUrlAgainstIssuer(url);\n\n        if (!httpsCheck) {\n            errors.push(\n                'https for all urls required. Also for urls received by discovery.'\n            );\n        }\n\n        if (!issuerCheck) {\n            errors.push(\n                'Every url in discovery document has to start with the issuer url.' +\n                'Also see property strictDiscoveryDocumentValidation.'\n            );\n        }\n\n        return errors;\n    }\n\n    private validateUrlForHttps(url: string): boolean {\n        if (!url) {\n            return true;\n        }\n\n        const lcUrl = url.toLowerCase();\n\n        if (this.requireHttps === false) {\n            return true;\n        }\n\n        if (\n            (lcUrl.match(/^http:\\/\\/localhost($|[:\\/])/) ||\n                lcUrl.match(/^http:\\/\\/localhost($|[:\\/])/)) &&\n            this.requireHttps === 'remoteOnly'\n        ) {\n            return true;\n        }\n\n        return lcUrl.startsWith('https://');\n    }\n\n    private validateUrlAgainstIssuer(url: string) {\n        if (!this.strictDiscoveryDocumentValidation) {\n            return true;\n        }\n        if (!url) {\n            return true;\n        }\n        return url.toLowerCase().startsWith(this.issuer.toLowerCase());\n    }\n\n    private setupRefreshTimer(): void {\n        if (typeof window === 'undefined') {\n            this.debug('timer not supported on this plattform');\n            return;\n        }\n\n        if (this.hasValidIdToken()) {\n            this.clearAccessTokenTimer();\n            this.clearIdTokenTimer();\n            this.setupExpirationTimers();\n        }\n\n        this.events.pipe(filter(e => e.type === 'token_received')).subscribe(_ => {\n            this.clearAccessTokenTimer();\n            this.clearIdTokenTimer();\n            this.setupExpirationTimers();\n        });\n    }\n\n    private setupExpirationTimers(): void {\n        const idTokenExp = this.getIdTokenExpiration() || Number.MAX_VALUE;\n        const accessTokenExp = this.getAccessTokenExpiration() || Number.MAX_VALUE;\n        const useAccessTokenExp = accessTokenExp <= idTokenExp;\n\n        if (this.hasValidAccessToken() && useAccessTokenExp) {\n            this.setupAccessTokenTimer();\n        }\n\n        if (this.hasValidIdToken() && !useAccessTokenExp) {\n            this.setupIdTokenTimer();\n        }\n    }\n\n    private setupAccessTokenTimer(): void {\n        const expiration = this.getAccessTokenExpiration();\n        const storedAt = this.getAccessTokenStoredAt();\n        const timeout = this.calcTimeout(storedAt, expiration);\n\n        this.ngZone.runOutsideAngular(() => {\n            this.accessTokenTimeoutSubscription = of(\n                new OAuthInfoEvent('token_expires', 'access_token')\n            )\n                .pipe(delay(timeout))\n                .subscribe(e => {\n                    this.ngZone.run(() => {\n                        this.eventsSubject.next(e);\n                    });\n                });\n        });\n    }\n\n    private setupIdTokenTimer(): void {\n        const expiration = this.getIdTokenExpiration();\n        const storedAt = this.getIdTokenStoredAt();\n        const timeout = this.calcTimeout(storedAt, expiration);\n\n        this.ngZone.runOutsideAngular(() => {\n            this.idTokenTimeoutSubscription = of(\n                new OAuthInfoEvent('token_expires', 'id_token')\n            )\n                .pipe(delay(timeout))\n                .subscribe(e => {\n                    this.ngZone.run(() => {\n                        this.eventsSubject.next(e);\n                    });\n                });\n        });\n    }\n\n    private clearAccessTokenTimer(): void {\n        if (this.accessTokenTimeoutSubscription) {\n            this.accessTokenTimeoutSubscription.unsubscribe();\n        }\n    }\n\n    private clearIdTokenTimer(): void {\n        if (this.idTokenTimeoutSubscription) {\n            this.idTokenTimeoutSubscription.unsubscribe();\n        }\n    }\n\n    private calcTimeout(storedAt: number, expiration: number): number {\n        const delta = (expiration - storedAt) * this.timeoutFactor;\n        return delta;\n    }\n\n    /**\n     * DEPRECATED. Use a provider for OAuthStorage instead:\n     *\n     * { provide: OAuthStorage, useValue: localStorage }\n     *\n     * Sets a custom storage used to store the received\n     * tokens on client side. By default, the browser's\n     * sessionStorage is used.\n     * @ignore\n     *\n     * @param storage\n     */\n    public setStorage(storage: OAuthStorage): void {\n        this._storage = storage;\n        this.configChanged();\n    }\n\n    /**\n     * Loads the discovery document to configure most\n     * properties of this service. The url of the discovery\n     * document is infered from the issuer's url according\n     * to the OpenId Connect spec. To use another url you\n     * can pass it to to optional parameter fullUrl.\n     *\n     * @param fullUrl\n     */\n    public loadDiscoveryDocument(fullUrl: string = null): Promise<object> {\n        return new Promise((resolve, reject) => {\n            if (!fullUrl) {\n                fullUrl = this.issuer || '';\n                if (!fullUrl.endsWith('/')) {\n                    fullUrl += '/';\n                }\n                fullUrl += '.well-known/openid-configuration';\n            }\n\n            if (!this.validateUrlForHttps(fullUrl)) {\n                reject('issuer must use Https. Also check property requireHttps.');\n                return;\n            }\n\n            this.http.get<OidcDiscoveryDoc>(fullUrl).subscribe(\n                doc => {\n                    if (!this.validateDiscoveryDocument(doc)) {\n                        this.eventsSubject.next(\n                            new OAuthErrorEvent('discovery_document_validation_error', null)\n                        );\n                        reject('discovery_document_validation_error');\n                        return;\n                    }\n\n                    this.loginUrl = doc.authorization_endpoint;\n                    this.logoutUrl = doc.end_session_endpoint || this.logoutUrl;\n                    this.grantTypesSupported = doc.grant_types_supported;\n                    this.issuer = doc.issuer;\n                    this.tokenEndpoint = doc.token_endpoint;\n                    this.userinfoEndpoint = doc.userinfo_endpoint;\n                    this.jwksUri = doc.jwks_uri;\n                    this.sessionCheckIFrameUrl = doc.check_session_iframe || this.sessionCheckIFrameUrl;\n\n                    this.discoveryDocumentLoaded = true;\n                    this.discoveryDocumentLoadedSubject.next(doc);\n\n                    if (this.sessionChecksEnabled) {\n                        this.restartSessionChecksIfStillLoggedIn();\n                    }\n\n                    this.loadJwks()\n                        .then(jwks => {\n                            const result: object = {\n                                discoveryDocument: doc,\n                                jwks: jwks\n                            };\n\n                            const event = new OAuthSuccessEvent(\n                                'discovery_document_loaded',\n                                result\n                            );\n                            this.eventsSubject.next(event);\n                            resolve(event);\n                            return;\n                        })\n                        .catch(err => {\n                            this.eventsSubject.next(\n                                new OAuthErrorEvent('discovery_document_load_error', err)\n                            );\n                            reject(err);\n                            return;\n                        });\n                },\n                err => {\n                    console.error('error loading discovery document', err);\n                    this.eventsSubject.next(\n                        new OAuthErrorEvent('discovery_document_load_error', err)\n                    );\n                    reject(err);\n                }\n            );\n        });\n    }\n\n    private loadJwks(): Promise<object> {\n        return new Promise<object>((resolve, reject) => {\n            if (this.jwksUri) {\n                this.http.get(this.jwksUri).subscribe(\n                    jwks => {\n                        this.jwks = jwks;\n                        this.eventsSubject.next(\n                            new OAuthSuccessEvent('discovery_document_loaded')\n                        );\n                        resolve(jwks);\n                    },\n                    err => {\n                        console.error('error loading jwks', err);\n                        this.eventsSubject.next(\n                            new OAuthErrorEvent('jwks_load_error', err)\n                        );\n                        reject(err);\n                    }\n                );\n            } else {\n                resolve(null);\n            }\n        });\n    }\n\n    private validateDiscoveryDocument(doc: OidcDiscoveryDoc): boolean {\n        let errors: string[];\n\n        if (!this.skipIssuerCheck && doc.issuer !== this.issuer) {\n            console.error(\n                'invalid issuer in discovery document',\n                'expected: ' + this.issuer,\n                'current: ' + doc.issuer\n            );\n            return false;\n        }\n\n        errors = this.validateUrlFromDiscoveryDocument(doc.authorization_endpoint);\n        if (errors.length > 0) {\n            console.error(\n                'error validating authorization_endpoint in discovery document',\n                errors\n            );\n            return false;\n        }\n\n        errors = this.validateUrlFromDiscoveryDocument(doc.end_session_endpoint);\n        if (errors.length > 0) {\n            console.error(\n                'error validating end_session_endpoint in discovery document',\n                errors\n            );\n            return false;\n        }\n\n        errors = this.validateUrlFromDiscoveryDocument(doc.token_endpoint);\n        if (errors.length > 0) {\n            console.error(\n                'error validating token_endpoint in discovery document',\n                errors\n            );\n        }\n\n        errors = this.validateUrlFromDiscoveryDocument(doc.userinfo_endpoint);\n        if (errors.length > 0) {\n            console.error(\n                'error validating userinfo_endpoint in discovery document',\n                errors\n            );\n            return false;\n        }\n\n        errors = this.validateUrlFromDiscoveryDocument(doc.jwks_uri);\n        if (errors.length > 0) {\n            console.error('error validating jwks_uri in discovery document', errors);\n            return false;\n        }\n\n        if (this.sessionChecksEnabled && !doc.check_session_iframe) {\n            console.warn(\n                'sessionChecksEnabled is activated but discovery document' +\n                ' does not contain a check_session_iframe field'\n            );\n        }\n\n        // this.sessionChecksEnabled = !!doc.check_session_iframe;\n\n        return true;\n    }\n\n    /**\n     * Uses password flow to exchange userName and password for an\n     * access_token. After receiving the access_token, this method\n     * uses it to query the userinfo endpoint in order to get information\n     * about the user in question.\n     *\n     * When using this, make sure that the property oidc is set to false.\n     * Otherwise stricter validations take happen that makes this operation\n     * fail.\n     *\n     * @param userName\n     * @param password\n     * @param headers Optional additional http-headers.\n     */\n    public fetchTokenUsingPasswordFlowAndLoadUserProfile(\n        userName: string,\n        password: string,\n        headers: HttpHeaders = new HttpHeaders()\n    ): Promise<object> {\n        return this.fetchTokenUsingPasswordFlow(userName, password, headers).then(\n            () => this.loadUserProfile()\n        );\n    }\n\n    /**\n     * Loads the user profile by accessing the user info endpoint defined by OpenId Connect.\n     *\n     * When using this with OAuth2 password flow, make sure that the property oidc is set to false.\n     * Otherwise stricter validations take happen that makes this operation\n     * fail.\n     */\n    public loadUserProfile(): Promise<object> {\n        if (!this.hasValidAccessToken()) {\n            throw new Error('Can not load User Profile without access_token');\n        }\n        if (!this.validateUrlForHttps(this.userinfoEndpoint)) {\n            throw new Error(\n                'userinfoEndpoint must use Http. Also check property requireHttps.'\n            );\n        }\n\n        return new Promise((resolve, reject) => {\n            const headers = new HttpHeaders().set(\n                'Authorization',\n                'Bearer ' + this.getAccessToken()\n            );\n\n            this.http.get<UserInfo>(this.userinfoEndpoint, { headers }).subscribe(\n                info => {\n                    this.debug('userinfo received', info);\n\n                    const existingClaims = this.getIdentityClaims() || {};\n\n                    if (!this.skipSubjectCheck) {\n                        if (\n                            this.oidc &&\n                            (!existingClaims['sub'] || info.sub !== existingClaims['sub'])\n                        ) {\n                            const err =\n                                'if property oidc is true, the received user-id (sub) has to be the user-id ' +\n                                'of the user that has logged in with oidc.\\n' +\n                                'if you are not using oidc but just oauth2 password flow set oidc to false';\n\n                            reject(err);\n                            return;\n                        }\n                    }\n\n                    info = Object.assign({}, existingClaims, info);\n\n                    this._storage.setItem('id_token_claims_obj', JSON.stringify(info));\n                    this.eventsSubject.next(new OAuthSuccessEvent('user_profile_loaded'));\n                    resolve(info);\n                },\n                err => {\n                    console.error('error loading user info', err);\n                    this.eventsSubject.next(\n                        new OAuthErrorEvent('user_profile_load_error', err)\n                    );\n                    reject(err);\n                }\n            );\n        });\n    }\n\n    /**\n     * Uses password flow to exchange userName and password for an access_token.\n     * @param userName\n     * @param password\n     * @param headers Optional additional http-headers.\n     */\n    public fetchTokenUsingPasswordFlow(\n        userName: string,\n        password: string,\n        headers: HttpHeaders = new HttpHeaders()\n    ): Promise<object> {\n        if (!this.validateUrlForHttps(this.tokenEndpoint)) {\n            throw new Error(\n                'tokenEndpoint must use Http. Also check property requireHttps.'\n            );\n        }\n\n        return new Promise((resolve, reject) => {\n            /**\n             * A `HttpParameterCodec` that uses `encodeURIComponent` and `decodeURIComponent` to\n             * serialize and parse URL parameter keys and values.\n             *\n             * @stable\n             */\n            let params = new HttpParams({ encoder: new WebHttpUrlEncodingCodec() })\n                .set('grant_type', 'password')\n                .set('scope', this.scope)\n                .set('username', userName)\n                .set('password', password);\n\n            if (this.useHttpBasicAuthForPasswordFlow) {\n                const header = btoa(`${this.clientId}:${this.dummyClientSecret}`);\n                headers = headers.set(\n                    'Authentication',\n                    'BASIC ' + header);\n            }\n\n            if (!this.useHttpBasicAuthForPasswordFlow) {\n                params = params.set('client_id', this.clientId);\n            }\n\n            if (!this.useHttpBasicAuthForPasswordFlow && this.dummyClientSecret) {\n                params = params.set('client_secret', this.dummyClientSecret);\n            }\n\n            if (this.customQueryParams) {\n                for (const key of Object.getOwnPropertyNames(this.customQueryParams)) {\n                    params = params.set(key, this.customQueryParams[key]);\n                }\n            }\n\n            headers = headers.set(\n                'Content-Type',\n                'application/x-www-form-urlencoded'\n            );\n\n            this.http\n                .post<TokenResponse>(this.tokenEndpoint, params, { headers })\n                .subscribe(\n                    tokenResponse => {\n                        this.debug('tokenResponse', tokenResponse);\n                        this.storeAccessTokenResponse(\n                            tokenResponse.access_token,\n                            tokenResponse.refresh_token,\n                            tokenResponse.expires_in,\n                            tokenResponse.scope\n                        );\n\n                        this.eventsSubject.next(new OAuthSuccessEvent('token_received'));\n                        resolve(tokenResponse);\n                    },\n                    err => {\n                        console.error('Error performing password flow', err);\n                        this.eventsSubject.next(new OAuthErrorEvent('token_error', err));\n                        reject(err);\n                    }\n                );\n        });\n    }\n\n    /**\n     * Refreshes the token using a refresh_token.\n     * This does not work for implicit flow, b/c\n     * there is no refresh_token in this flow.\n     * A solution for this is provided by the\n     * method silentRefresh.\n     */\n    public refreshToken(): Promise<object> {\n        if (!this.validateUrlForHttps(this.tokenEndpoint)) {\n            throw new Error(\n                'tokenEndpoint must use Http. Also check property requireHttps.'\n            );\n        }\n\n        return new Promise((resolve, reject) => {\n            let params = new HttpParams()\n                .set('grant_type', 'refresh_token')\n                .set('client_id', this.clientId)\n                .set('scope', this.scope)\n                .set('refresh_token', this._storage.getItem('refresh_token'));\n\n            if (this.dummyClientSecret) {\n                params = params.set('client_secret', this.dummyClientSecret);\n            }\n\n            if (this.customQueryParams) {\n                for (const key of Object.getOwnPropertyNames(this.customQueryParams)) {\n                    params = params.set(key, this.customQueryParams[key]);\n                }\n            }\n\n            const headers = new HttpHeaders().set(\n                'Content-Type',\n                'application/x-www-form-urlencoded'\n            );\n\n            this.http\n                .post<TokenResponse>(this.tokenEndpoint, params, { headers })\n                .subscribe(\n                    tokenResponse => {\n                        this.debug('refresh tokenResponse', tokenResponse);\n                        this.storeAccessTokenResponse(\n                            tokenResponse.access_token,\n                            tokenResponse.refresh_token,\n                            tokenResponse.expires_in,\n                            tokenResponse.scope\n                        );\n\n                        this.eventsSubject.next(new OAuthSuccessEvent('token_received'));\n                        this.eventsSubject.next(new OAuthSuccessEvent('token_refreshed'));\n                        resolve(tokenResponse);\n                    },\n                    err => {\n                        console.error('Error performing password flow', err);\n                        this.eventsSubject.next(\n                            new OAuthErrorEvent('token_refresh_error', err)\n                        );\n                        reject(err);\n                    }\n                );\n        });\n    }\n\n    private removeSilentRefreshEventListener(): void {\n        if (this.silentRefreshPostMessageEventListener) {\n            window.removeEventListener(\n                'message',\n                this.silentRefreshPostMessageEventListener\n            );\n            this.silentRefreshPostMessageEventListener = null;\n        }\n    }\n\n    private setupSilentRefreshEventListener(): void {\n        this.removeSilentRefreshEventListener();\n\n        this.silentRefreshPostMessageEventListener = (e: MessageEvent) => {\n            let expectedPrefix = '#';\n\n            if (this.silentRefreshMessagePrefix) {\n                expectedPrefix += this.silentRefreshMessagePrefix;\n            }\n\n            if (!e || !e.data || typeof e.data !== 'string') {\n                return;\n            }\n\n            const prefixedMessage: string = e.data;\n\n            if (!prefixedMessage.startsWith(expectedPrefix)) {\n                return;\n            }\n\n            const message = '#' + prefixedMessage.substr(expectedPrefix.length);\n\n            this.tryLogin({\n                customHashFragment: message,\n                preventClearHashAfterLogin: true,\n                onLoginError: err => {\n                    this.eventsSubject.next(\n                        new OAuthErrorEvent('silent_refresh_error', err)\n                    );\n                },\n                onTokenReceived: () => {\n                    this.eventsSubject.next(new OAuthSuccessEvent('silently_refreshed'));\n                }\n            }).catch(err => this.debug('tryLogin during silent refresh failed', err));\n        };\n\n        window.addEventListener(\n            'message',\n            this.silentRefreshPostMessageEventListener\n        );\n    }\n\n    /**\n     * Performs a silent refresh for implicit flow.\n     * Use this method to get a new tokens when/ before\n     * the existing tokens expires.\n     */\n    public silentRefresh(params: object = {}, noPrompt = true): Promise<OAuthEvent> {\n        const claims: object = this.getIdentityClaims() || {};\n\n        if (this.useIdTokenHintForSilentRefresh && this.hasValidIdToken()) {\n            params['id_token_hint'] = this.getIdToken();\n        }\n\n        /*\n            if (!claims) {\n                throw new Error('cannot perform a silent refresh as the user is not logged in');\n            }\n            */\n\n        if (!this.validateUrlForHttps(this.loginUrl)) {\n            throw new Error(\n                'tokenEndpoint must use Https. Also check property requireHttps.'\n            );\n        }\n\n        if (typeof document === 'undefined') {\n            throw new Error('silent refresh is not supported on this platform');\n        }\n\n        const existingIframe = document.getElementById(\n            this.silentRefreshIFrameName\n        );\n        if (existingIframe) {\n            document.body.removeChild(existingIframe);\n        }\n\n        this.silentRefreshSubject = claims['sub'];\n\n        const iframe = document.createElement('iframe');\n        iframe.id = this.silentRefreshIFrameName;\n\n        this.setupSilentRefreshEventListener();\n\n        const redirectUri = this.silentRefreshRedirectUri || this.redirectUri;\n        this.createLoginUrl(null, null, redirectUri, noPrompt, params).then(url => {\n            iframe.setAttribute('src', url);\n\n            if (!this.silentRefreshShowIFrame) {\n                iframe.style['display'] = 'none';\n            }\n            document.body.appendChild(iframe);\n        });\n\n        const errors = this.events.pipe(\n            filter(e => e instanceof OAuthErrorEvent),\n            first()\n        );\n        const success = this.events.pipe(\n            filter(e => e.type === 'silently_refreshed'),\n            first()\n        );\n        const timeout = of(\n            new OAuthErrorEvent('silent_refresh_timeout', null)\n        ).pipe(delay(this.silentRefreshTimeout));\n\n        return race([errors, success, timeout])\n            .pipe(\n                tap(e => {\n                    if (e.type === 'silent_refresh_timeout') {\n                        this.eventsSubject.next(e);\n                    }\n                }),\n                map(e => {\n                    if (e instanceof OAuthErrorEvent) {\n                        throw e;\n                    }\n                    return e;\n                })\n            )\n            .toPromise();\n    }\n\n    private canPerformSessionCheck(): boolean {\n        if (!this.sessionChecksEnabled) {\n            return false;\n        }\n        if (!this.sessionCheckIFrameUrl) {\n            console.warn(\n                'sessionChecksEnabled is activated but there ' +\n                'is no sessionCheckIFrameUrl'\n            );\n            return false;\n        }\n        const sessionState = this.getSessionState();\n        if (!sessionState) {\n            console.warn(\n                'sessionChecksEnabled is activated but there ' + 'is no session_state'\n            );\n            return false;\n        }\n        if (typeof document === 'undefined') {\n            return false;\n        }\n\n        return true;\n    }\n\n    private setupSessionCheckEventListener(): void {\n        this.removeSessionCheckEventListener();\n\n        this.sessionCheckEventListener = (e: MessageEvent) => {\n            const origin = e.origin.toLowerCase();\n            const issuer = this.issuer.toLowerCase();\n\n            this.debug('sessionCheckEventListener');\n\n            if (!issuer.startsWith(origin)) {\n                this.debug(\n                    'sessionCheckEventListener',\n                    'wrong origin',\n                    origin,\n                    'expected',\n                    issuer\n                );\n            }\n\n            switch (e.data) {\n                case 'unchanged':\n                    this.handleSessionUnchanged();\n                    break;\n                case 'changed':\n                    this.handleSessionChange();\n                    break;\n                case 'error':\n                    this.handleSessionError();\n                    break;\n            }\n\n            this.debug('got info from session check inframe', e);\n        };\n\n        window.addEventListener('message', this.sessionCheckEventListener);\n    }\n\n    private handleSessionUnchanged(): void {\n        this.debug('session check', 'session unchanged');\n    }\n\n    private handleSessionChange(): void {\n        /* events: session_changed, relogin, stopTimer, logged_out*/\n        this.eventsSubject.next(new OAuthInfoEvent('session_changed'));\n        this.stopSessionCheckTimer();\n        if (this.silentRefreshRedirectUri) {\n            this.silentRefresh().catch(_ =>\n                this.debug('silent refresh failed after session changed')\n            );\n            this.waitForSilentRefreshAfterSessionChange();\n        } else {\n            this.eventsSubject.next(new OAuthInfoEvent('session_terminated'));\n            this.logOut(true);\n        }\n    }\n\n    private waitForSilentRefreshAfterSessionChange() {\n        this.events\n            .pipe(\n                filter(\n                    (e: OAuthEvent) =>\n                        e.type === 'silently_refreshed' ||\n                        e.type === 'silent_refresh_timeout' ||\n                        e.type === 'silent_refresh_error'\n                ),\n                first()\n            )\n            .subscribe(e => {\n                if (e.type !== 'silently_refreshed') {\n                    this.debug('silent refresh did not work after session changed');\n                    this.eventsSubject.next(new OAuthInfoEvent('session_terminated'));\n                    this.logOut(true);\n                }\n            });\n    }\n\n    private handleSessionError(): void {\n        this.stopSessionCheckTimer();\n        this.eventsSubject.next(new OAuthInfoEvent('session_error'));\n    }\n\n    private removeSessionCheckEventListener(): void {\n        if (this.sessionCheckEventListener) {\n            window.removeEventListener('message', this.sessionCheckEventListener);\n            this.sessionCheckEventListener = null;\n        }\n    }\n\n    private initSessionCheck(): void {\n        if (!this.canPerformSessionCheck()) {\n            return;\n        }\n\n        const existingIframe = document.getElementById(this.sessionCheckIFrameName);\n        if (existingIframe) {\n            document.body.removeChild(existingIframe);\n        }\n\n        const iframe = document.createElement('iframe');\n        iframe.id = this.sessionCheckIFrameName;\n\n        this.setupSessionCheckEventListener();\n\n        const url = this.sessionCheckIFrameUrl;\n        iframe.setAttribute('src', url);\n        // iframe.style.visibility = 'hidden';\n        iframe.style.display = 'none';\n        document.body.appendChild(iframe);\n\n        this.startSessionCheckTimer();\n    }\n\n    private startSessionCheckTimer(): void {\n        this.stopSessionCheckTimer();\n        this.sessionCheckTimer = setInterval(\n            this.checkSession.bind(this),\n            this.sessionCheckIntervall\n        );\n    }\n\n    private stopSessionCheckTimer(): void {\n        if (this.sessionCheckTimer) {\n            clearInterval(this.sessionCheckTimer);\n            this.sessionCheckTimer = null;\n        }\n    }\n\n    private checkSession(): void {\n        const iframe: any = document.getElementById(this.sessionCheckIFrameName);\n\n        if (!iframe) {\n            console.warn(\n                'checkSession did not find iframe',\n                this.sessionCheckIFrameName\n            );\n        }\n\n        const sessionState = this.getSessionState();\n\n        if (!sessionState) {\n            this.stopSessionCheckTimer();\n        }\n\n        const message = this.clientId + ' ' + sessionState;\n        iframe.contentWindow.postMessage(message, this.issuer);\n    }\n\n    private createLoginUrl(\n        state = '',\n        loginHint = '',\n        customRedirectUri = '',\n        noPrompt = false,\n        params: object = {}\n    ) {\n        const that = this;\n\n        let redirectUri: string;\n\n        if (customRedirectUri) {\n            redirectUri = customRedirectUri;\n        } else {\n            redirectUri = this.redirectUri;\n        }\n\n        return this.createAndSaveNonce().then((nonce: any) => {\n            if (state) {\n                state = nonce + this.config.nonceStateSeparator + state;\n            } else {\n                state = nonce;\n            }\n\n            if (!this.requestAccessToken && !this.oidc) {\n                throw new Error(\n                    'Either requestAccessToken or oidc or both must be true'\n                );\n            }\n\n            if (this.oidc && this.requestAccessToken) {\n                this.responseType = 'id_token token';\n            } else if (this.oidc && !this.requestAccessToken) {\n                this.responseType = 'id_token';\n            } else {\n                this.responseType = 'token';\n            }\n\n            const seperationChar = that.loginUrl.indexOf('?') > -1 ? '&' : '?';\n\n            let scope = that.scope;\n\n            if (this.oidc && !scope.match(/(^|\\s)openid($|\\s)/)) {\n                scope = 'openid ' + scope;\n            }\n\n            let url =\n                that.loginUrl +\n                seperationChar +\n                'response_type=' +\n                encodeURIComponent(that.responseType) +\n                '&client_id=' +\n                encodeURIComponent(that.clientId) +\n                '&state=' +\n                encodeURIComponent(state) +\n                '&redirect_uri=' +\n                encodeURIComponent(redirectUri) +\n                '&scope=' +\n                encodeURIComponent(scope);\n\n            if (loginHint) {\n                url += '&login_hint=' + encodeURIComponent(loginHint);\n            }\n\n            if (that.resource) {\n                url += '&resource=' + encodeURIComponent(that.resource);\n            }\n\n            if (that.oidc) {\n                url += '&nonce=' + encodeURIComponent(nonce);\n            }\n\n            if (noPrompt) {\n                url += '&prompt=none';\n            }\n\n            for (const key of Object.keys(params)) {\n                url +=\n                    '&' + encodeURIComponent(key) + '=' + encodeURIComponent(params[key]);\n            }\n\n            if (this.customQueryParams) {\n                for (const key of Object.getOwnPropertyNames(this.customQueryParams)) {\n                    url +=\n                        '&' + key + '=' + encodeURIComponent(this.customQueryParams[key]);\n                }\n            }\n\n            return url;\n        });\n    }\n\n    initImplicitFlowInternal(\n        additionalState = '',\n        params: string | object = ''\n    ): void {\n        if (this.inImplicitFlow) {\n            return;\n        }\n\n        this.inImplicitFlow = true;\n\n        if (!this.validateUrlForHttps(this.loginUrl)) {\n            throw new Error(\n                'loginUrl must use Http. Also check property requireHttps.'\n            );\n        }\n\n        let addParams: object = {};\n        let loginHint: string = null;\n\n        if (typeof params === 'string') {\n            loginHint = params;\n        } else if (typeof params === 'object') {\n            addParams = params;\n        }\n\n        this.createLoginUrl(additionalState, loginHint, null, false, addParams)\n            .then(this.config.openUri)\n            .catch(error => {\n                console.error('Error in initImplicitFlow');\n                console.error(error);\n                this.inImplicitFlow = false;\n            });\n    }\n\n    /**\n     * Starts the implicit flow and redirects to user to\n     * the auth servers login url.\n     *\n     * @param additionalState Optinal state that is passes around.\n     *  You find this state in the property ``state`` after ``tryLogin`` logged in the user.\n     * @param params Hash with additional parameter. If it is a string, it is used for the\n     *               parameter loginHint (for the sake of compatibility with former versions)\n     */\n    public initImplicitFlow(\n        additionalState = '',\n        params: string | object = ''\n    ): void {\n        if (this.loginUrl !== '') {\n            this.initImplicitFlowInternal(additionalState, params);\n        } else {\n            this.events\n                .pipe(filter(e => e.type === 'discovery_document_loaded'))\n                .subscribe(_ => this.initImplicitFlowInternal(additionalState, params));\n        }\n    }\n\n    private callOnTokenReceivedIfExists(options: LoginOptions): void {\n        const that = this;\n        if (options.onTokenReceived) {\n            const tokenParams = {\n                idClaims: that.getIdentityClaims(),\n                idToken: that.getIdToken(),\n                accessToken: that.getAccessToken(),\n                state: that.state\n            };\n            options.onTokenReceived(tokenParams);\n        }\n    }\n\n    private storeAccessTokenResponse(\n        accessToken: string,\n        refreshToken: string,\n        expiresIn: number,\n        grantedScopes: String\n    ): void {\n        this._storage.setItem('access_token', accessToken);\n        if (grantedScopes) {\n            this._storage.setItem('granted_scopes', JSON.stringify(grantedScopes.split('+')));\n        }\n        this._storage.setItem('access_token_stored_at', '' + Date.now());\n        if (expiresIn) {\n            const expiresInMilliSeconds = expiresIn * 1000;\n            const now = new Date();\n            const expiresAt = now.getTime() + expiresInMilliSeconds;\n            this._storage.setItem('expires_at', '' + expiresAt);\n        }\n\n        if (refreshToken) {\n            this._storage.setItem('refresh_token', refreshToken);\n        }\n    }\n\n    /**\n     * Checks whether there are tokens in the hash fragment\n     * as a result of the implicit flow. These tokens are\n     * parsed, validated and used to sign the user in to the\n     * current client.\n     *\n     * @param options Optinal options.\n     */\n    public tryLogin(options: LoginOptions = null): Promise<void> {\n        options = options || {};\n\n        let parts: object;\n\n        if (options.customHashFragment) {\n            parts = this.urlHelper.getHashFragmentParams(options.customHashFragment);\n        } else {\n            parts = this.urlHelper.getHashFragmentParams();\n        }\n\n        this.debug('parsed url', parts);\n\n        const state = parts['state'];\n        let nonceInState = state;\n\n        if (state) {\n            const idx = state.indexOf(this.config.nonceStateSeparator);\n\n            if (idx > -1) {\n                nonceInState = state.substr(0, idx);\n                this.state = state.substr(idx + this.config.nonceStateSeparator.length);\n            }\n        }\n\n        if (parts['error']) {\n            this.debug('error trying to login');\n            this.handleLoginError(options, parts);\n            const err = new OAuthErrorEvent('token_error', {}, parts);\n            this.eventsSubject.next(err);\n            return Promise.reject(err);\n        }\n\n        const accessToken = parts['access_token'];\n        const idToken = parts['id_token'];\n        const sessionState = parts['session_state'];\n        const grantedScopes = parts['scope'];\n\n        if (!this.requestAccessToken && !this.oidc) {\n            return Promise.reject(\n                'Either requestAccessToken or oidc or both must be true.'\n            );\n        }\n\n        if (this.requestAccessToken && !accessToken) {\n            return Promise.resolve();\n        }\n        if (this.requestAccessToken && !options.disableOAuth2StateCheck && !state) {\n            return Promise.resolve();\n        }\n        if (this.oidc && !idToken) {\n            return Promise.resolve();\n        }\n\n        if (this.sessionChecksEnabled && !sessionState) {\n            console.warn(\n                'session checks (Session Status Change Notification) ' +\n                'is activated in the configuration but the id_token ' +\n                'does not contain a session_state claim'\n            );\n        }\n\n        if (this.requestAccessToken && !options.disableOAuth2StateCheck) {\n            const success = this.validateNonceForAccessToken(\n                accessToken,\n                nonceInState\n            );\n            if (!success) {\n                const event = new OAuthErrorEvent('invalid_nonce_in_state', null);\n                this.eventsSubject.next(event);\n                return Promise.reject(event);\n            }\n        }\n\n        if (this.requestAccessToken) {\n            this.storeAccessTokenResponse(\n                accessToken,\n                null,\n                parts['expires_in'] || this.fallbackAccessTokenExpirationTimeInSec,\n                grantedScopes\n            );\n        }\n\n        if (!this.oidc) {\n            this.eventsSubject.next(new OAuthSuccessEvent('token_received'));\n            if (this.clearHashAfterLogin && !options.preventClearHashAfterLogin) {\n                location.hash = '';\n            }\n            return Promise.resolve();\n        }\n\n        return this.processIdToken(idToken, accessToken)\n            .then(result => {\n                if (options.validationHandler) {\n                    return options\n                        .validationHandler({\n                            accessToken: accessToken,\n                            idClaims: result.idTokenClaims,\n                            idToken: result.idToken,\n                            state: state\n                        })\n                        .then(_ => result);\n                }\n                return result;\n            })\n            .then(result => {\n                this.storeIdToken(result);\n                this.storeSessionState(sessionState);\n                if (this.clearHashAfterLogin) {\n                    location.hash = '';\n                }\n                this.eventsSubject.next(new OAuthSuccessEvent('token_received'));\n                this.callOnTokenReceivedIfExists(options);\n                this.inImplicitFlow = false;\n            })\n            .catch(reason => {\n                this.eventsSubject.next(\n                    new OAuthErrorEvent('token_validation_error', reason)\n                );\n                console.error('Error validating tokens');\n                console.error(reason);\n                return Promise.reject(reason);\n            });\n    }\n\n    private validateNonceForAccessToken(\n        accessToken: string,\n        nonceInState: string\n    ): boolean {\n        const savedNonce = this._storage.getItem('nonce');\n        if (savedNonce !== nonceInState) {\n            const err = 'validating access_token failed. wrong state/nonce.';\n            console.error(err, savedNonce, nonceInState);\n            return false;\n        }\n        return true;\n    }\n\n    protected storeIdToken(idToken: ParsedIdToken) {\n        this._storage.setItem('id_token', idToken.idToken);\n        this._storage.setItem('id_token_claims_obj', idToken.idTokenClaimsJson);\n        this._storage.setItem('id_token_expires_at', '' + idToken.idTokenExpiresAt);\n        this._storage.setItem('id_token_stored_at', '' + Date.now());\n    }\n\n    protected storeSessionState(sessionState: string): void {\n        this._storage.setItem('session_state', sessionState);\n    }\n\n    protected getSessionState(): string {\n        return this._storage.getItem('session_state');\n    }\n\n    private handleLoginError(options: LoginOptions, parts: object): void {\n        if (options.onLoginError) {\n            options.onLoginError(parts);\n        }\n        if (this.clearHashAfterLogin) {\n            location.hash = '';\n        }\n    }\n\n    /**\n     * @ignore\n     */\n    public processIdToken(\n        idToken: string,\n        accessToken: string\n    ): Promise<ParsedIdToken> {\n        const tokenParts = idToken.split('.');\n        const headerBase64 = this.padBase64(tokenParts[0]);\n        const headerJson = b64DecodeUnicode(headerBase64);\n        const header = JSON.parse(headerJson);\n        const claimsBase64 = this.padBase64(tokenParts[1]);\n        const claimsJson = b64DecodeUnicode(claimsBase64);\n        const claims = JSON.parse(claimsJson);\n        const savedNonce = this._storage.getItem('nonce');\n\n        if (Array.isArray(claims.aud)) {\n            if (claims.aud.every(v => v !== this.clientId)) {\n                const err = 'Wrong audience: ' + claims.aud.join(',');\n                console.warn(err);\n                return Promise.reject(err);\n            }\n        } else {\n            if (claims.aud !== this.clientId) {\n                const err = 'Wrong audience: ' + claims.aud;\n                console.warn(err);\n                return Promise.reject(err);\n            }\n        }\n\n        /*\n            if (this.getKeyCount() > 1 && !header.kid) {\n                let err = 'There needs to be a kid property in the id_token header when multiple keys are defined via the property jwks';\n                console.warn(err);\n                return Promise.reject(err);\n            }\n            */\n\n        if (!claims.sub) {\n            const err = 'No sub claim in id_token';\n            console.warn(err);\n            return Promise.reject(err);\n        }\n\n        /* For now, we only check whether the sub against\n             * silentRefreshSubject when sessionChecksEnabled is on\n             * We will reconsider in a later version to do this\n             * in every other case too.\n             */\n        if (\n            this.sessionChecksEnabled &&\n            this.silentRefreshSubject &&\n            this.silentRefreshSubject !== claims['sub']\n        ) {\n            const err =\n                'After refreshing, we got an id_token for another user (sub). ' +\n                `Expected sub: ${this.silentRefreshSubject}, received sub: ${\n                claims['sub']\n                }`;\n\n            console.warn(err);\n            return Promise.reject(err);\n        }\n\n        if (!claims.iat) {\n            const err = 'No iat claim in id_token';\n            console.warn(err);\n            return Promise.reject(err);\n        }\n\n        if (claims.iss !== this.issuer) {\n            const err = 'Wrong issuer: ' + claims.iss;\n            console.warn(err);\n            return Promise.reject(err);\n        }\n\n        if (claims.nonce !== savedNonce) {\n            const err = 'Wrong nonce: ' + claims.nonce;\n            console.warn(err);\n            return Promise.reject(err);\n        }\n\n        if (\n            !this.disableAtHashCheck &&\n            this.requestAccessToken &&\n            !claims['at_hash']\n        ) {\n            const err = 'An at_hash is needed!';\n            console.warn(err);\n            return Promise.reject(err);\n        }\n\n        const now = Date.now();\n        const issuedAtMSec = claims.iat * 1000;\n        const expiresAtMSec = claims.exp * 1000;\n        const tenMinutesInMsec = 1000 * 60 * 10;\n\n        if (\n            issuedAtMSec - tenMinutesInMsec >= now ||\n            expiresAtMSec + tenMinutesInMsec <= now\n        ) {\n            const err = 'Token has been expired';\n            console.error(err);\n            console.error({\n                now: now,\n                issuedAtMSec: issuedAtMSec,\n                expiresAtMSec: expiresAtMSec\n            });\n            return Promise.reject(err);\n        }\n\n        const validationParams: ValidationParams = {\n            accessToken: accessToken,\n            idToken: idToken,\n            jwks: this.jwks,\n            idTokenClaims: claims,\n            idTokenHeader: header,\n            loadKeys: () => this.loadJwks()\n        };\n\n        if (\n            !this.disableAtHashCheck &&\n            this.requestAccessToken &&\n            !this.checkAtHash(validationParams)\n        ) {\n            const err = 'Wrong at_hash';\n            console.warn(err);\n            return Promise.reject(err);\n        }\n\n        return this.checkSignature(validationParams).then(_ => {\n            const result: ParsedIdToken = {\n                idToken: idToken,\n                idTokenClaims: claims,\n                idTokenClaimsJson: claimsJson,\n                idTokenHeader: header,\n                idTokenHeaderJson: headerJson,\n                idTokenExpiresAt: expiresAtMSec\n            };\n            return result;\n        });\n    }\n\n    /**\n     * Returns the received claims about the user.\n     */\n    public getIdentityClaims(): object {\n        const claims = this._storage.getItem('id_token_claims_obj');\n        if (!claims) {\n            return null;\n        }\n        return JSON.parse(claims);\n    }\n\n    /**\n     * Returns the granted scopes from the server.\n     */\n    public getGrantedScopes(): object {\n        const scopes = this._storage.getItem('granted_scopes');\n        if (!scopes) {\n            return null;\n        }\n        return JSON.parse(scopes);\n    }\n\n    /**\n     * Returns the current id_token.\n     */\n    public getIdToken(): string {\n        return this._storage\n            ? this._storage.getItem('id_token')\n            : null;\n    }\n\n    private padBase64(base64data): string {\n        while (base64data.length % 4 !== 0) {\n            base64data += '=';\n        }\n        return base64data;\n    }\n\n    /**\n     * Returns the current access_token.\n     */\n    public getAccessToken(): string {\n        return this._storage.getItem('access_token');\n    }\n\n    public getRefreshToken(): string {\n        return this._storage.getItem('refresh_token');\n    }\n\n    /**\n     * Returns the expiration date of the access_token\n     * as milliseconds since 1970.\n     */\n    public getAccessTokenExpiration(): number {\n        if (!this._storage.getItem('expires_at')) {\n            return null;\n        }\n        return parseInt(this._storage.getItem('expires_at'), 10);\n    }\n\n    private getAccessTokenStoredAt(): number {\n        return parseInt(this._storage.getItem('access_token_stored_at'), 10);\n    }\n\n    private getIdTokenStoredAt(): number {\n        return parseInt(this._storage.getItem('id_token_stored_at'), 10);\n    }\n\n    /**\n     * Returns the expiration date of the id_token\n     * as milliseconds since 1970.\n     */\n    public getIdTokenExpiration(): number {\n        if (!this._storage.getItem('id_token_expires_at')) {\n            return null;\n        }\n\n        return parseInt(this._storage.getItem('id_token_expires_at'), 10);\n    }\n\n    /**\n     * Checkes, whether there is a valid access_token.\n     */\n    public hasValidAccessToken(): boolean {\n        if (this.getAccessToken()) {\n            const expiresAt = this._storage.getItem('expires_at');\n            const now = new Date();\n            if (expiresAt && parseInt(expiresAt, 10) < now.getTime()) {\n                return false;\n            }\n\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Checkes, whether there is a valid id_token.\n     */\n    public hasValidIdToken(): boolean {\n        if (this.getIdToken()) {\n            const expiresAt = this._storage.getItem('id_token_expires_at');\n            const now = new Date();\n            if (expiresAt && parseInt(expiresAt, 10) < now.getTime()) {\n                return false;\n            }\n\n            return true;\n        }\n\n        return false;\n    }\n\n    /**\n     * Returns the auth-header that can be used\n     * to transmit the access_token to a service\n     */\n    public authorizationHeader(): string {\n        return 'Bearer ' + this.getAccessToken();\n    }\n\n    /**\n     * Removes all tokens and logs the user out.\n     * If a logout url is configured, the user is\n     * redirected to it.\n     * @param noRedirectToLogoutUrl\n     */\n    public logOut(noRedirectToLogoutUrl = false): void {\n        const id_token = this.getIdToken();\n        this._storage.removeItem('access_token');\n        this._storage.removeItem('id_token');\n        this._storage.removeItem('refresh_token');\n        this._storage.removeItem('nonce');\n        this._storage.removeItem('expires_at');\n        this._storage.removeItem('id_token_claims_obj');\n        this._storage.removeItem('id_token_expires_at');\n        this._storage.removeItem('id_token_stored_at');\n        this._storage.removeItem('access_token_stored_at');\n        this._storage.removeItem('granted_scopes');\n        this._storage.removeItem('session_state');\n\n        this.silentRefreshSubject = null;\n\n        this.eventsSubject.next(new OAuthInfoEvent('logout'));\n\n        if (!this.logoutUrl) {\n            return;\n        }\n        if (noRedirectToLogoutUrl) {\n            return;\n        }\n\n        if (!id_token && !this.postLogoutRedirectUri) {\n            return;\n        }\n\n        let logoutUrl: string;\n\n        if (!this.validateUrlForHttps(this.logoutUrl)) {\n            throw new Error(\n                'logoutUrl must use Http. Also check property requireHttps.'\n            );\n        }\n\n        // For backward compatibility\n        if (this.logoutUrl.indexOf('{{') > -1) {\n            logoutUrl = this.logoutUrl\n                .replace(/\\{\\{id_token\\}\\}/, id_token)\n                .replace(/\\{\\{client_id\\}\\}/, this.clientId);\n        } else {\n\n            let params = new HttpParams();\n\n            if (id_token) {\n                params = params.set('id_token_hint', id_token);\n            }\n\n            const postLogoutUrl = this.postLogoutRedirectUri || this.redirectUri;\n            if (postLogoutUrl) {\n                params = params.set('post_logout_redirect_uri', postLogoutUrl);\n            }\n\n            logoutUrl =\n                this.logoutUrl +\n                (this.logoutUrl.indexOf('?') > -1 ? '&' : '?') +\n                params.toString()\n        }\n        this.config.openUri(logoutUrl);\n    }\n\n    /**\n     * @ignore\n     */\n    public createAndSaveNonce(): Promise<string> {\n        const that = this;\n        return this.createNonce().then(function (nonce: any) {\n            that._storage.setItem('nonce', nonce);\n            return nonce;\n        });\n    }\n\n    protected createNonce(): Promise<string> {\n        return new Promise((resolve, reject) => {\n            if (this.rngUrl) {\n                throw new Error(\n                    'createNonce with rng-web-api has not been implemented so far'\n                );\n            } else {\n                let text = '';\n                const possible =\n                    'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n                for (let i = 0; i < 40; i++) {\n                    text += possible.charAt(Math.floor(Math.random() * possible.length));\n                }\n\n                resolve(text);\n            }\n        });\n    }\n\n    private checkAtHash(params: ValidationParams): boolean {\n        if (!this.tokenValidationHandler) {\n            console.warn(\n                'No tokenValidationHandler configured. Cannot check at_hash.'\n            );\n            return true;\n        }\n        return this.tokenValidationHandler.validateAtHash(params);\n    }\n\n    private checkSignature(params: ValidationParams): Promise<any> {\n        if (!this.tokenValidationHandler) {\n            console.warn(\n                'No tokenValidationHandler configured. Cannot check signature.'\n            );\n            return Promise.resolve(null);\n        }\n        return this.tokenValidationHandler.validateSignature(params);\n    }\n}\n",
    "import { HttpParameterCodec } from '@angular/common/http';\n/**\n * This custom encoder allows charactes like +, % and / to be used in passwords\n */\nexport class WebHttpUrlEncodingCodec implements HttpParameterCodec {\n  encodeKey(k: string): string {\n    return encodeURIComponent(k);\n  }\n\n  encodeValue(v: string): string {\n    return encodeURIComponent(v);\n  }\n\n  decodeKey(k: string): string {\n    return decodeURIComponent(k);\n  }\n\n  decodeValue(v: string) {\n    return decodeURIComponent(v);\n  }\n}\n",
    "export class AuthConfig {\n  /**\n   * The client's id as registered with the auth server\n   */\n  public clientId? = '';\n\n  /**\n   * The client's redirectUri as registered with the auth server\n   */\n  public redirectUri? = '';\n\n  /**\n   * An optional second redirectUri where the auth server\n   * redirects the user to after logging out.\n   */\n  public postLogoutRedirectUri? = '';\n\n  /**\n   * The auth server's endpoint that allows to log\n   * the user in when using implicit flow.\n   */\n  public loginUrl? = '';\n\n  /**\n   * The requested scopes\n   */\n  public scope? = 'openid profile';\n\n  public resource? = '';\n\n  public rngUrl? = '';\n\n  /**\n   * Defines whether to use OpenId Connect during\n   * implicit flow.\n   */\n  public oidc? = true;\n\n  /**\n   * Defines whether to request a access token during\n   * implicit flow.\n   */\n  public requestAccessToken? = true;\n\n  public options?: any = null;\n\n  /**\n   * The issuer's uri.\n   */\n  public issuer? = '';\n\n  /**\n   * The logout url.\n   */\n  public logoutUrl? = '';\n\n  /**\n   * Defines whether to clear the hash fragment after logging in.\n   */\n  public clearHashAfterLogin? = true;\n\n  /**\n   * Url of the token endpoint as defined by OpenId Connect and OAuth 2.\n   */\n  public tokenEndpoint?: string = null;\n\n  /**\n   * Url of the userinfo endpoint as defined by OpenId Connect.\n   *\n   */\n  public userinfoEndpoint?: string = null;\n\n  public responseType? = 'token';\n\n  /**\n   * Defines whether additional debug information should\n   * be shown at the console. Note that in certain browsers\n   * the verbosity of the console needs to be explicitly set\n   * to include Debug level messages.\n   */\n   public showDebugInformation? = false;\n\n  /**\n   * The redirect uri used when doing silent refresh.\n   */\n  public silentRefreshRedirectUri? = '';\n\n  public silentRefreshMessagePrefix? = '';\n\n  /**\n   * Set this to true to display the iframe used for\n   * silent refresh for debugging.\n   */\n  public silentRefreshShowIFrame? = false;\n\n  /**\n   * Timeout for silent refresh.\n   * @internal\n   * depreacted b/c of typo, see silentRefreshTimeout\n   */\n  public siletRefreshTimeout?: number = 1000 * 20;\n\n  /**\n   * Timeout for silent refresh.\n   */\n  public silentRefreshTimeout?: number = 1000 * 20;\n\n  /**\n   * Some auth servers don't allow using password flow\n   * w/o a client secreat while the standards do not\n   * demand for it. In this case, you can set a password\n   * here. As this passwort is exposed to the public\n   * it does not bring additional security and is therefore\n   * as good as using no password.\n   */\n  public dummyClientSecret?: string = null;\n\n  /**\n   * Defines whether https is required.\n   * The default value is remoteOnly which only allows\n   * http for localhost, while every other domains need\n   * to be used with https.\n   */\n  public requireHttps?: boolean | 'remoteOnly' = 'remoteOnly';\n\n  /**\n   * Defines whether every url provided by the discovery\n   * document has to start with the issuer's url.\n   */\n  public strictDiscoveryDocumentValidation? = true;\n\n  /**\n   * JSON Web Key Set (https://tools.ietf.org/html/rfc7517)\n   * with keys used to validate received id_tokens.\n   * This is taken out of the disovery document. Can be set manually too.\n   */\n  public jwks?: object = null;\n\n  /**\n   * Map with additional query parameter that are appended to\n   * the request when initializing implicit flow.\n   */\n  public customQueryParams?: object = null;\n\n  public silentRefreshIFrameName? = 'angular-oauth-oidc-silent-refresh-iframe';\n\n  /**\n   * Defines when the token_timeout event should be raised.\n   * If you set this to the default value 0.75, the event\n   * is triggered after 75% of the token's life time.\n   */\n  public timeoutFactor? = 0.75;\n\n  /**\n   * If true, the lib will try to check whether the user\n   * is still logged in on a regular basis as described\n   * in http://openid.net/specs/openid-connect-session-1_0.html#ChangeNotification\n   */\n  public sessionChecksEnabled? = false;\n\n  /**\n   * Intervall in msec for checking the session\n   * according to http://openid.net/specs/openid-connect-session-1_0.html#ChangeNotification\n   */\n  public sessionCheckIntervall? = 3 * 1000;\n\n  /**\n   * Url for the iframe used for session checks\n   */\n  public sessionCheckIFrameUrl?: string = null;\n\n  /**\n   * Name of the iframe to use for session checks\n   */\n  public sessionCheckIFrameName? = 'angular-oauth-oidc-check-session-iframe';\n\n  /**\n   * This property has been introduced to disable at_hash checks\n   * and is indented for Identity Provider that does not deliver\n   * an at_hash EVEN THOUGH its recommended by the OIDC specs.\n   * Of course, when disabling these checks the we are bypassing\n   * a security check which means we are more vulnerable.\n   */\n  public disableAtHashCheck? = false;\n\n  /*\n     * Defines wether to check the subject of a refreshed token after silent refresh.\n     * Normally, it should be the same as before.\n    */\n  public skipSubjectCheck? = false;\n\n  public useIdTokenHintForSilentRefresh? = false;\n\n  /*\n     * Defined whether to skip the validation of the issuer in the discovery document.\n     * Normally, the discovey document's url starts with the url of the issuer.\n     */\n  public skipIssuerCheck? = false;\n\n  /**\n   * According to rfc6749 it is recommended (but not required) that the auth\n   * server exposes the access_token's life time in seconds.\n   * This is a fallback value for the case this value is not exposed.\n   */\n  public fallbackAccessTokenExpirationTimeInSec?: number;\n\n  /*\n     * final state sent to issuer is built as follows:\n     * state = nonce + nonceStateSeparator + additional state\n     * Default separator is ';' (encoded %3B).\n     * In rare cases, this character might be forbidden or inconvenient to use by the issuer so it can be customized.\n     */\n  public nonceStateSeparator? = ';';\n\n  /*\n   * set this to true to use HTTP BASIC auth for password flow\n  */\n  public useHttpBasicAuthForPasswordFlow? = false;\n\n  constructor(json?: Partial<AuthConfig>) {\n    if (json) {\n      Object.assign(this, json);\n    }\n  }\n\n  /**\n   * This property allows you to override the method that is used to open the login url,\n   * allowing a way for implementations to specify their own method of routing to new\n   * urls.\n   */\n  public openUri?: ((uri: string) => void) = uri => {\n    location.href = uri;\n  }\n}\n",
    "// see: https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding#The_.22Unicode_Problem.22\nexport function b64DecodeUnicode(str) {\n  const base64 = str.replace(/\\-/g, '+').replace(/\\_/g, '/');\n\n  return decodeURIComponent(\n    atob(base64)\n      .split('')\n      .map(function(c) {\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n      })\n      .join('')\n  );\n}\n",
    "export type EventType =\n  | 'discovery_document_loaded'\n  | 'received_first_token'\n  | 'jwks_load_error'\n  | 'invalid_nonce_in_state'\n  | 'discovery_document_load_error'\n  | 'discovery_document_validation_error'\n  | 'user_profile_loaded'\n  | 'user_profile_load_error'\n  | 'token_received'\n  | 'token_error'\n  | 'token_refreshed'\n  | 'token_refresh_error'\n  | 'silent_refresh_error'\n  | 'silently_refreshed'\n  | 'silent_refresh_timeout'\n  | 'token_validation_error'\n  | 'token_expires'\n  | 'session_changed'\n  | 'session_error'\n  | 'session_terminated'\n  | 'logout';\n\nexport abstract class OAuthEvent {\n  constructor(readonly type: EventType) {}\n}\n\nexport class OAuthSuccessEvent extends OAuthEvent {\n  constructor(type: EventType, readonly info: any = null) {\n    super(type);\n  }\n}\n\nexport class OAuthInfoEvent extends OAuthEvent {\n  constructor(type: EventType, readonly info: any = null) {\n    super(type);\n  }\n}\n\nexport class OAuthErrorEvent extends OAuthEvent {\n  constructor(\n    type: EventType,\n    readonly reason: object,\n    readonly params: object = null\n  ) {\n    super(type);\n  }\n}\n",
    "import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class UrlHelperService {\n  public getHashFragmentParams(customHashFragment?: string): object {\n    let hash = customHashFragment || window.location.hash;\n\n    hash = decodeURIComponent(hash);\n\n    if (hash.indexOf('#') !== 0) {\n      return {};\n    }\n\n    const questionMarkPosition = hash.indexOf('?');\n\n    if (questionMarkPosition > -1) {\n      hash = hash.substr(questionMarkPosition + 1);\n    } else {\n      hash = hash.substr(1);\n    }\n\n    return this.parseQueryString(hash);\n  }\n\n  public parseQueryString(queryString: string): object {\n    const data = {};\n    let\n      pairs,\n      pair,\n      separatorIndex,\n      escapedKey,\n      escapedValue,\n      key,\n      value;\n\n    if (queryString === null) {\n      return data;\n    }\n\n    pairs = queryString.split('&');\n\n    for (let i = 0; i < pairs.length; i++) {\n      pair = pairs[i];\n      separatorIndex = pair.indexOf('=');\n\n      if (separatorIndex === -1) {\n        escapedKey = pair;\n        escapedValue = null;\n      } else {\n        escapedKey = pair.substr(0, separatorIndex);\n        escapedValue = pair.substr(separatorIndex + 1);\n      }\n\n      key = decodeURIComponent(escapedKey);\n      value = decodeURIComponent(escapedValue);\n\n      if (key.substr(0, 1) === '/') { key = key.substr(1); }\n\n      data[key] = value;\n    }\n\n    return data;\n  }\n}\n",
    "export interface ValidationParams {\n  idToken: string;\n  accessToken: string;\n  idTokenHeader: object;\n  idTokenClaims: object;\n  jwks: object;\n  loadKeys: () => Promise<object>;\n}\n\n/**\n * Interface for Handlers that are hooked in to\n * validate tokens.\n */\nexport abstract class ValidationHandler {\n  /**\n   * Validates the signature of an id_token.\n   */\n  public abstract validateSignature(\n    validationParams: ValidationParams\n  ): Promise<any>;\n\n  /**\n   * Validates the at_hash in an id_token against the received access_token.\n   */\n  public abstract validateAtHash(validationParams: ValidationParams): boolean;\n}\n\n/**\n * This abstract implementation of ValidationHandler already implements\n * the method validateAtHash. However, to make use of it,\n * you have to override the method calcHash.\n */\nexport abstract class AbstractValidationHandler implements ValidationHandler {\n  /**\n   * Validates the signature of an id_token.\n   */\n  abstract validateSignature(validationParams: ValidationParams): Promise<any>;\n\n  /**\n   * Validates the at_hash in an id_token against the received access_token.\n   */\n  validateAtHash(params: ValidationParams): boolean {\n    let hashAlg = this.inferHashAlgorithm(params.idTokenHeader);\n\n    let tokenHash = this.calcHash(params.accessToken, hashAlg); // sha256(accessToken, { asString: true });\n\n    let leftMostHalf = tokenHash.substr(0, tokenHash.length / 2);\n\n    let tokenHashBase64 = btoa(leftMostHalf);\n\n    let atHash = tokenHashBase64\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n      .replace(/=/g, '');\n    let claimsAtHash = params.idTokenClaims['at_hash'].replace(/=/g, '');\n\n    if (atHash !== claimsAtHash) {\n      console.error('exptected at_hash: ' + atHash);\n      console.error('actual at_hash: ' + claimsAtHash);\n    }\n\n    return atHash === claimsAtHash;\n  }\n\n  /**\n   * Infers the name of the hash algorithm to use\n   * from the alg field of an id_token.\n   *\n   * @param jwtHeader the id_token's parsed header\n   */\n  protected inferHashAlgorithm(jwtHeader: object): string {\n    let alg: string = jwtHeader['alg'];\n\n    if (!alg.match(/^.S[0-9]{3}$/)) {\n      throw new Error('Algorithm not supported: ' + alg);\n    }\n\n    return 'sha' + alg.substr(2);\n  }\n\n  /**\n   * Calculates the hash for the passed value by using\n   * the passed hash algorithm.\n   *\n   * @param valueToHash\n   * @param algorithm\n   */\n  protected abstract calcHash(valueToHash: string, algorithm: string): string;\n}\n",
    "/**\n * Additional options that can be passt to tryLogin.\n */\nexport class LoginOptions {\n  /**\n   * Is called, after a token has been received and\n   * successfully validated.\n   *\n   * Deprecated:  Use property ``events`` on OAuthService instead.\n   */\n  onTokenReceived?: (receivedTokens: ReceivedTokens) => void;\n\n  /**\n   * Hook, to validate the received tokens.\n   * Deprecated:  Use property ``tokenValidationHandler`` on OAuthService instead.\n   */\n  validationHandler?: (receivedTokens: ReceivedTokens) => Promise<any>;\n\n  /**\n   * Called when tryLogin detects that the auth server\n   * included an error message into the hash fragment.\n   *\n   * Deprecated:  Use property ``events`` on OAuthService instead.\n   */\n  onLoginError?: (params: object) => void;\n\n  /**\n   * A custom hash fragment to be used instead of the\n   * actual one. This is used for silent refreshes, to\n   * pass the iframes hash fragment to this method.\n   */\n  customHashFragment?: string;\n\n  /**\n   * Set this to true to disable the oauth2 state\n   * check which is a best practice to avoid\n   * security attacks.\n   * As OIDC defines a nonce check that includes\n   * this, this can be set to true when only doing\n   * OIDC.\n   */\n  disableOAuth2StateCheck?: boolean;\n\n  /**\n   * Normally, you want to clear your hash fragment after\n   * the lib read the token(s) so that they are not displayed\n   * anymore in the url. If not, set this to true.\n   */\n  preventClearHashAfterLogin? = false;\n}\n\n/**\n * Defines a simple storage that can be used for\n * storing the tokens at client side.\n * Is compatible to localStorage and sessionStorage,\n * but you can also create your own implementations.\n */\nexport abstract class OAuthStorage {\n  abstract getItem(key: string): string | null;\n  abstract removeItem(key: string): void;\n  abstract setItem(key: string, data: string): void;\n}\n\n/**\n * Represents the received tokens, the received state\n * and the parsed claims from the id-token.\n */\nexport class ReceivedTokens {\n  idToken: string;\n  accessToken: string;\n  idClaims?: object;\n  state?: string;\n}\n\n/**\n * Represents the parsed and validated id_token.\n */\nexport interface ParsedIdToken {\n  idToken: string;\n  idTokenClaims: object;\n  idTokenHeader: object;\n  idTokenClaimsJson: string;\n  idTokenHeaderJson: string;\n  idTokenExpiresAt: number;\n}\n\n/**\n * Represents the response from the token endpoint\n * http://openid.net/specs/openid-connect-core-1_0.html#TokenEndpoint\n */\nexport interface TokenResponse {\n  access_token: string;\n  token_type: string;\n  expires_in: number;\n  refresh_token: string;\n  scope: string;\n  state?: string;\n}\n\n/**\n * Represents the response from the user info endpoint\n * http://openid.net/specs/openid-connect-core-1_0.html#UserInfo\n */\nexport interface UserInfo {\n  sub: string;\n  [key: string]: any;\n}\n\n/**\n * Represents an OpenID Connect discovery document\n */\nexport interface OidcDiscoveryDoc {\n  issuer: string;\n  authorization_endpoint: string;\n  token_endpoint: string;\n  token_endpoint_auth_methods_supported: string[];\n  token_endpoint_auth_signing_alg_values_supported: string[];\n  userinfo_endpoint: string;\n  check_session_iframe: string;\n  end_session_endpoint: string;\n  jwks_uri: string;\n  registration_endpoint: string;\n  scopes_supported: string[];\n  response_types_supported: string[];\n  acr_values_supported: string[];\n  response_modes_supported: string[];\n  grant_types_supported: string[];\n  subject_types_supported: string[];\n  userinfo_signing_alg_values_supported: string[];\n  userinfo_encryption_alg_values_supported: string[];\n  userinfo_encryption_enc_values_supported: string[];\n  id_token_signing_alg_values_supported: string[];\n  id_token_encryption_alg_values_supported: string[];\n  id_token_encryption_enc_values_supported: string[];\n  request_object_signing_alg_values_supported: string[];\n  display_values_supported: string[];\n  claim_types_supported: string[];\n  claims_supported: string[];\n  claims_parameter_supported: boolean;\n  service_documentation: string;\n  ui_locales_supported: string[];\n}\n",
    "/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; }; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator];\r\n    return m ? m.call(o) : typeof __values === \"function\" ? __values(o) : o[Symbol.iterator]();\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n"
  ],
  "names": [
    "InjectionToken",
    "rs.KJUR",
    "rs.KEYUTIL",
    "tslib_1.__extends",
    "CommonModule",
    "NgModule",
    "HTTP_INTERCEPTORS",
    "Optional",
    "Injectable",
    "catchError",
    "throwError",
    "HttpClient",
    "NgZone",
    "HttpParams",
    "filter",
    "tslib_1.__values",
    "first",
    "map",
    "tap",
    "race",
    "of",
    "delay",
    "HttpHeaders",
    "Subject",
    "http"
  ],
  "mappings": "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"
}
